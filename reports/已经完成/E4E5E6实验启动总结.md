# E4/E5/E6实验启动总结

## 启动时间
2025-11-10 22:29 - 22:31

## 实验状态
✅ **已启动并运行中**

### 运行进程
- `run_e_experiments.py` (PID: 28088) - 主脚本运行中
- `replay_harness.py` (PID: 24660) - E6组回测运行中

### 输出目录
- `runtime/optimizer/group_e4_validation/backtest_20251110_222934/` - E4组（已创建）
- `runtime/optimizer/group_e5_validation/backtest_20251110_223018/` - E5组（已创建）
- `runtime/optimizer/group_e6_validation/backtest_20251110_223108/` - E6组（运行中）

---

## 实验配置

### E4组：E1入口节流 + E2 Maker策略合并
**关键参数**：
- `weak_signal_threshold: 0.78` (E1)
- `consistency_min: 0.48` (E1)
- `dedupe_ms: 6000` (E1)
- `maker_fee_ratio: 0.35` (E2)
- `scenario_probs.Q_L: 0.90` (E2)
- `scenario_probs.A_L: 0.80` (E2)
- `force_timeout_exit: true` (修复)
- `max_hold_time_sec: 3600` (修复)

**验收标准**：
- `trades_per_hour ≤ 25`（中位数）
- `cost_bps ≤ 1.85`（中位数）
- `maker_ratio_actual`显著提升

### E5组：TP/SL + 死区回调
**关键参数**：
- `take_profit_bps: 15` (从18回调)
- `stop_loss_bps: 8` (从6回调)
- `deadband_bps: 1.5` (从3回调)

**验收标准**：
- `avg_pnl_per_trade ≥ 0`（P25分位）
- `win_rate ≥ 30%`

### E6组：极限降频闸
**关键参数**：
- `weak_signal_threshold: 0.80` (极限收紧)
- `consistency_min: 0.50` (极限收紧)
- `dedupe_ms: 8000` (极限收紧)
- `min_consecutive: 4` (连击确认加严)

**验收标准**：
- `trades_per_hour ≤ 20`（中位数）
- `win_rate ≥ 25%`

---

## 预期完成时间

每个实验约60分钟（60分钟回测），三个实验顺序运行，总时间约180分钟（3小时）。

**预计完成时间**：2025-11-10 25:30（约3小时后）

---

## 监控命令

### 检查运行状态
```powershell
python scripts/check_e_experiments_status.py
```

### 检查进程
```powershell
Get-Process python | Where-Object { $_.CommandLine -like "*run_e_experiments*" }
```

### 检查输出目录
```powershell
Get-ChildItem runtime\optimizer\group_e*_validation -Directory | Select-Object Name, LastWriteTime
```

---

## 验收命令

实验完成后运行：
```powershell
python scripts/validate_e456_experiments.py
```

---

## 本轮"通过"标准（四条）

1. **频率**：≤ 20/h（中位数；若E6通过，E4/E5以此为硬约束）
2. **成本**：`cost_bps ≤ 1.75` 且 `maker_ratio_actual`显著提升
3. **单笔收益**：`avg_pnl_per_trade ≥ 0`（P25）
4. **稳健性**：三交易对都不过分掉队（ETH不能明显为负）

---

## 下一步

1. **等待实验完成**（约3小时）
2. **运行验收脚本**检查结果
3. **分析成本观测指标**：
   - 检查`maker_ratio_actual`是否提升
   - 对比`effective_spread_bps`的P50/P95
4. **根据验收结果决定下一步**：
   - 如果通过，进入下一轮优化
   - 如果Maker比例未提升，进入费用路径验证流程

---

## 文件清单

### 配置文件
- ✅ `runtime/optimizer/group_e4_combined.yaml`
- ✅ `runtime/optimizer/group_e5_optimized_tp_sl.yaml`
- ✅ `runtime/optimizer/group_e6_ultra_low_tps.yaml`

### 执行脚本
- ✅ `scripts/run_e_experiments.py` (已更新，支持E4/E5/E6)
- ✅ `scripts/validate_e456_experiments.py` (新建验收脚本)
- ✅ `scripts/check_e_experiments_status.py` (状态检查脚本)

### 文档
- ✅ `reports/E4E5E6实验执行说明.md`
- ✅ `reports/E4E5E6实验启动总结.md` (本文档)

---

## 注意事项

1. **P0修复已应用**：
   - 持仓超长退出逻辑修复（`force_timeout_exit`优先级提升）
   - 成本观测指标已添加（`maker_ratio_actual`, `effective_spread_bps_p50/p95`）

2. **实验并行运行**：
   - E4/E5/E6顺序运行（避免资源竞争）
   - 每个实验独立回测，互不影响

3. **结果保存**：
   - 所有结果自动保存到`runtime/optimizer/e_experiments_comparison.json`
   - 验收结果保存到`runtime/optimizer/e456_experiments_validation.json`

