---
id: "TASK-B3"
title: "å®æ—¶æ¨¡å¼ + å¹‚ç­‰æ‰§è¡Œï¼ˆExecution Workerï¼‰"
stage: "B"
priority: "P0"
status: "âœ… Completed"
owners: "TBD"
deps: ["TASK-B1", "TASK-05", "TASK-06", "TASK-07"]
estimate: "~3d"
created: "2025-11-11"
risk: "ä¸­"
tags: ["MCP", "Broker", "Execution", "Realtime"]
---

## 1. èƒŒæ™¯ / åœºæ™¯

åœ¨ A ç»„ä»»åŠ¡ä¸­ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆï¼š

- Harvester â†’ CoreAlgorithm â†’ `mcp.signal_server`ï¼Œå¯ä»¥åœ¨ **å®æ—¶æ¨¡å¼** ä¸‹æŒç»­äº§å‡ºä¿¡å·ï¼š
  - JSONL Sinkï¼š`V13_SINK=jsonl V13_OUTPUT_DIR=./runtime`  
  - SQLite Sinkï¼š`V13_SINK=sqlite V13_OUTPUT_DIR=./runtime`
- CoreAlgorithm é€šè¿‡ `log_signal` å°†ä¿¡å·è¾“å‡ºåˆ°ç»Ÿä¸€è·¯å¾„ï¼š
  - JSONLï¼š`$V13_OUTPUT_DIR/ready/signal/{symbol}/signals_YYYYMMDD_HHMM.jsonl`

å½“å‰ç¼ºå£ï¼š**è¿˜æ²¡æœ‰ä¸€ä¸ªâ€œå®æ—¶æ‰§è¡Œ Workerâ€**ï¼Œå¯ä»¥åœ¨ **é•¿è·‘æ¨¡å¼** ä¸‹ï¼š

1. æŒç»­æ¶ˆè´¹ `signal_server` äº§ç‰©ï¼›
2. åšå¹‚ç­‰æ§åˆ¶ï¼ˆé¿å…é‡å¤ä¸‹å• / é‡å¤æ‰§è¡Œï¼‰ï¼›
3. æŒ‰ç»Ÿä¸€ä¸šåŠ¡æµå†™å…¥ `runtime/executions/*`ï¼ˆä»¥åŠåç»­å¯¹æ¥çœŸå®äº¤æ˜“ / æ¨¡æ‹Ÿäº¤æ˜“ï¼‰ã€‚

TASK-B3 å°±æ˜¯è¦è¡¥ä¸Šè¿™å—ï¼š**â€œå®æ—¶æ¨¡å¼ï¼ˆä»…è¯» signalsï¼‰+ å¹‚ç­‰æ‰§è¡Œï¼Œç¨³å®šé•¿è·‘çš„æ‰§è¡Œ Workerâ€**ã€‚

---

## 2. ç›®æ ‡ï¼ˆGoalsï¼‰

### 2.1 æ ¸å¿ƒç›®æ ‡

1. **å®æ—¶æ‰§è¡Œ Worker**  
   - ä» `mcp.signal_server` äº§å‡ºçš„ä¿¡å·æµï¼ˆJSONL / SQLiteï¼‰ä¸­æŒç»­æ‹‰æµï¼›
   - æŒ‰é¡ºåºå¤„ç†æ¯æ¡ä¿¡å·ï¼Œç”Ÿæˆæ‰§è¡Œè®°å½•ï¼Œå†™å…¥ `runtime/executions/*`ã€‚

2. **å¹‚ç­‰æ‰§è¡Œï¼ˆIdempotent Executionï¼‰**  
   - æ‰€æœ‰æ‰§è¡Œè¡Œä¸ºä»¥ `signal_id` + `order_id` ä¸ºå¹‚ç­‰é”®ï¼›
   - ä»»æ„é‡å¤æŠ•é€’ / è¿›ç¨‹é‡å¯ / Orchestrator é‡å¤å¯åŠ¨ **éƒ½ä¸ä¼šé‡å¤ä¸‹å•æˆ–é‡å¤å†™å…¥æ‰§è¡Œè®°å½•**ã€‚

3. **ç¨³å®šé•¿è·‘ï¼ˆç¨³å®š 1 å°æ—¶+ï¼‰**  
   - åœ¨ 1 å°æ—¶ä»¥ä¸Šå®æ—¶è¿è¡Œä¸­ï¼Œä¸æ¼è¯»ã€ä¸é‡æ”¾ã€ä¸å´©æºƒï¼›
   - å®•æœºåå¯ä»ä¸Šæ¬¡ **é«˜æ°´ä½ offset** æ¢å¤ç»§ç»­æ‰§è¡Œã€‚

4. **ç»Ÿä¸€ä¸šåŠ¡æµ & å‚æ•°å¯¹é½**  
   - è¾“å…¥éµå¾ª `CoreAlgorithm.log_signal` çš„ schemaï¼›
   - è¾“å‡º `runtime/executions/*` çš„ schema å¯¹é½åç»­ PnL / æŠ¥è¡¨ï¼ˆTASK-08/09ï¼‰ï¼›
   - é…ç½®/å‚æ•°å¯¹é½ `config/defaults.yaml` ä¸ `V13_*` ç¯å¢ƒå˜é‡ï¼Œä¸å¼•å…¥â€œå­¤ç«‹é…ç½®â€ã€‚

### 2.2 éç›®æ ‡ï¼ˆOut of Scopeï¼‰

- ä¸åœ¨æœ¬ä»»åŠ¡å†…å®ç°å¤æ‚ä¸‹å•é€»è¾‘ï¼ˆçœŸå®äº¤æ˜“ / ä»¿çœŸæ’®åˆï¼‰ï¼›  
  æœ¬ä»»åŠ¡åªè¦æ±‚ï¼š**æ‰§è¡Œ Worker + å¹‚ç­‰æœºåˆ¶ + æ‰§è¡Œäº§ç‰©**ï¼Œä¸‹å•é€šé“å¯ä»¥å…ˆç”¨ **stub / dry-run adapter**ã€‚
- ä¸åœ¨æœ¬ä»»åŠ¡å†…ä¼˜åŒ–æ”¶ç›Šã€è°ƒå‚ã€PnL åˆ†æï¼ˆå±äº TASK-08/09 èŒƒå›´ï¼‰ã€‚

---

## 3. ä¾èµ–ä¸å¯¹é½

- **TASK-B1**ï¼šå®æ—¶æ¨¡å¼çš„ä¿¡å·æœåŠ¡ï¼ˆ`mcp.signal_server.app`ï¼‰ï¼Œä¿è¯æŒç»­äº§å‡ºä¿¡å·ã€‚
- **TASK-05**ï¼š`CORE_ALGO` ä¿¡å·æœåŠ¡ï¼Œå®šä¹‰äº†ä¿¡å·å­—æ®µåŠ `log_signal` è¾“å‡ºå¥‘çº¦ã€‚
- **TASK-06**ï¼šStrategyMode & é£æ§æŠ¤æ ï¼Œæ‰§è¡Œ Worker éœ€è¦å°Šé‡ `gating` / `guard_reason` å­—æ®µã€‚
- **TASK-07**ï¼šOrchestrator ç¼–æ’ï¼Œæ‰§è¡Œ Worker éœ€è¦ä¸ `--enable harvest,signal,broker,report` ä¸­çš„ `broker` é˜¶æ®µå¯¹é½ã€‚

---

## 4. è¾“å…¥ / è¾“å‡º & æ•°æ®å¥‘çº¦

### 4.1 è¾“å…¥ï¼š`signal_server` äº§ç‰©ï¼ˆç»Ÿä¸€å¥‘çº¦ï¼‰

**JSONL Sinkï¼ˆé»˜è®¤ç®€å•è·¯å¾„ï¼‰ï¼š**

- è·¯å¾„ï¼š  
  `$V13_OUTPUT_DIR/ready/signal/{symbol}/signals_YYYYMMDD_HHMM.jsonl`
- å•æ¡è®°å½•å­—æ®µï¼ˆæ ¸å¿ƒï¼‰ï¼š
  - `ts_ms`: int, ä¿¡å·æ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰
  - `symbol`: str, äº¤æ˜“å¯¹ï¼ˆå¦‚ `BTCUSDT`ï¼‰
  - `score`: float, ç»¼åˆä¿¡å·åˆ†æ•°
  - `z_ofi`: float
  - `z_cvd`: float
  - `regime`: str, åœºæ™¯æ ‡ç­¾
  - `div_type`: str, èƒŒç¦»ç±»å‹
  - `confirm`: bool, æ˜¯å¦ç¡®è®¤
  - `gating`: str, é£æ§ gate ç»“æœï¼ˆå¦‚ `ok` / `low_consistency` / `spread_bps_exceeded` ç­‰ï¼‰
  - `guard_reason`: str | null, æŠ¤æ åŸå› ï¼Œé `ok` æ—¶å¡«å……

**SQLite Sinkï¼ˆå¹¶å‘å‹å¥½ï¼‰ï¼š**

- è·¯å¾„ï¼š`$V13_OUTPUT_DIR/signals.db`ï¼ˆçº¦å®šï¼‰  
- è¡¨ç»“æ„ï¼ˆå‚è€ƒ JSONL å­—æ®µï¼‰ï¼Œè‡³å°‘åŒ…å«ï¼š
  - `id`ï¼ˆè‡ªå¢ PK æˆ– `row_id`ï¼‰
  - ä¸Šè¿° JSON å­—æ®µï¼ˆts_ms, symbol, score, gating, guard_reason, ...ï¼‰

> æ‰§è¡Œ Worker å¿…é¡»å…¼å®¹ **ä¸¤ä¸ª Sink æ¨¡å¼**ï¼Œå¹¶é€šè¿‡ `V13_SINK` è‡ªåŠ¨åˆ‡æ¢ã€‚

### 4.2 è¾“å‡ºï¼š`runtime/executions/*` äº§ç‰©

**JSONL æ¨¡å¼ï¼š**

- è·¯å¾„çº¦å®šï¼š  
  `$V13_OUTPUT_DIR/executions/{symbol}/exec_{YYYYMMDD_HH}.jsonl`
- å­—æ®µå»ºè®®ï¼ˆå¯¹é½åç»­ PnLï¼‰ï¼š
  - `exec_ts_ms`: æ‰§è¡Œæ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰
  - `signal_ts_ms`: å¯¹åº”ä¿¡å·æ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰
  - `symbol`: äº¤æ˜“å¯¹
  - `signal_id`: å¹‚ç­‰é”®çš„ä¸€éƒ¨åˆ†ï¼ˆè§ 5.2ï¼‰
  - `order_id`: æœ¬åœ°è®¢å• ID æˆ–å¤–éƒ¨è®¢å• IDï¼ˆè‹¥å®é™…ä¸‹å•ï¼‰
  - `side`: `"long"` / `"short"` / `"flat"` / `"skip"`
  - `qty`: æ‰§è¡Œæ•°é‡ï¼ˆä¸º 0 è¡¨ç¤ºä»…è®°å½•â€œè§‚å¯Ÿä¿¡å·â€ï¼‰
  - `price`: æ‰§è¡Œä»·æ ¼ï¼ˆè‹¥æ— çœŸå®æ’®åˆï¼Œç”¨ mid / last price å ä½ï¼‰
  - `gating`: ç›´æ¥é€ä¼ ä¿¡å·çš„ `gating` å­—æ®µ
  - `guard_reason`: é€ä¼ ä¿¡å·çš„ `guard_reason`
  - `status`: `"success"` / `"skip"` / `"failed"` / `"retry"`
  - `error_code`: å¤–éƒ¨é”™è¯¯ç ï¼ˆå¯é€‰ï¼‰
  - `error_msg`: é”™è¯¯è¯¦æƒ…ï¼ˆå¯é€‰ï¼‰
  - `meta_json`: é¢å¤–å…ƒæ•°æ®ï¼ˆå¦‚é‡è¯•æ¬¡æ•°ã€å»¶è¿Ÿã€adapter åç§°ç­‰ï¼‰

**SQLite æ¨¡å¼ï¼š**

- è·¯å¾„çº¦å®šï¼š  
  `$V13_OUTPUT_DIR/executions/executions.db`
- è¡¨ `executions`ï¼ˆå»ºè®®ï¼‰ï¼š
  - ä¸ JSONL ä¸­å­—æ®µç›¸å¯¹åº”ï¼›
  - **å”¯ä¸€ç´¢å¼•**ï¼š`UNIQUE(symbol, signal_id, order_id)` â€”â€” ç”¨äºå¹‚ç­‰å»é‡ã€‚

---

## 5. æŠ€æœ¯æ–¹æ¡ˆï¼ˆä¿æŒå…¨å±€ä¸€è‡´æ€§ï¼‰

### 5.1 æ–‡ä»¶ç›‘å¬ä¸æ‰§è¡Œ Worker

> å¯¹é½ç°æœ‰æ¶æ„ï¼š**Broker å±‚æ˜¯ MCP è–„å£³ï¼Œç®—æ³•é€»è¾‘æ²‰æ·€åœ¨ core / adapterï¼ŒOrchestrator åšç¼–æ’ã€‚**

1. æ–°å»ºæ¨¡å—ï¼ˆå»ºè®®è·¯å¾„ï¼‰ï¼š
   - `src/executor/execution_worker.py`
2. æä¾›ç»Ÿä¸€å…¥å£ï¼š
   - `python -m executor.execution_worker --config ./config/defaults.yaml`
3. æ ¸å¿ƒèŒè´£ï¼š
   - è§£æé…ç½®ï¼šè¯»å– `V13_SINK`, `V13_OUTPUT_DIR`, ä»¥åŠ `config.execution.*`
   - æ„å»º `SignalStream`ï¼š
     - **JSONL**ï¼šè½®è¯¢ `ready/signal/{symbol}/*.jsonl`ï¼ŒæŒ‰æ–‡ä»¶åï¼ˆæ—¶é—´ï¼‰æ’åºï¼Œé€è¡Œè¯»å–ï¼›
     - **SQLite**ï¼šä» `signals.db` ä¸­æŒ‰ `id` æˆ– `ts_ms` å¢é‡æ‹‰å–ã€‚
   - å°†ä¿¡å·è½¬æˆå†…éƒ¨ç»Ÿä¸€ç»“æ„ `ExecutionSignal`ï¼Œé¢„ç•™ä¸‹å•å­—æ®µï¼ˆside, qty, priceï¼‰ã€‚

### 5.2 å¹‚ç­‰ä¿è¯ï¼ˆIdempotencyï¼‰

1. **å¹‚ç­‰é”®è®¾è®¡ï¼š**

   - `signal_id`ï¼šåŸºäºä¿¡å·å†…å®¹æ„é€ ç¨³å®š keyï¼Œä¾‹å¦‚ï¼š  
     `signal_id = stable_row_id(f"{symbol}|{ts_ms}|{score:.4f}|{regime}|{div_type}")`  
     ï¼ˆå¤ç”¨ harvester é‡Œçš„ `stable_row_id` æ€è·¯ï¼Œç¡®ä¿è·¨è¿›ç¨‹ä¸€è‡´ï¼‰
   - `order_id`ï¼š
     - è‹¥ä½¿ç”¨çœŸå®ä¸‹å•é€šé“ï¼Œåˆ™é€ä¼ å¤–éƒ¨ orderIdï¼›
     - è‹¥å½“å‰ä¸º dry-run / stub æ¨¡å¼ï¼Œåˆ™ç”Ÿæˆæœ¬åœ° `order_id = "dryrun:{signal_id}"`ã€‚

2. **çŠ¶æ€å­˜å‚¨ï¼š**

   - ä½¿ç”¨ SQLiteï¼š`$V13_OUTPUT_DIR/executions/executions.db` ä¸­ï¼š
     - è¡¨ `executions`ï¼Œå”¯ä¸€ç´¢å¼• `UNIQUE(symbol, signal_id, order_id)`ï¼›
     - ä½œä¸ºå¹‚ç­‰â€œçœŸç›¸æºï¼ˆsource of truthï¼‰â€ï¼›
   - å¯åŠ¨æ—¶æ ¹æ® `executions` ä¸­çš„ `max(ts_ms)` ä¸ºæ¯ä¸ª symbol è®¡ç®— **é«˜æ°´ä½ `high_water_ts_ms`**ï¼Œç”¨äºè·³è¿‡å·²å¤„ç†è¿‡çš„æ—§ä¿¡å·ã€‚

3. **å¤„ç†æµç¨‹ï¼ˆç®€åŒ–ç‰ˆï¼‰ï¼š**

   - è¯»å–ä¸€æ¡ä¿¡å· â†’ è®¡ç®— `signal_id` å’Œå€™é€‰ `order_id`ï¼›
   - å°è¯•æ’å…¥ `executions` è®°å½•ï¼ˆçŠ¶æ€ `pending`ï¼‰ï¼š
     - è‹¥å”¯ä¸€ç´¢å¼•å†²çª â‡’ è¯´æ˜å·²å¤„ç†è¿‡ï¼Œ**ç›´æ¥è·³è¿‡**ï¼›
     - è‹¥æ’å…¥æˆåŠŸ â‡’ è¿›å…¥çœŸæ­£æ‰§è¡Œï¼ˆä¸‹å• / æ¨¡æ‹Ÿæ‰§è¡Œï¼‰ï¼›
   - æ‰§è¡Œå®Œæˆåï¼Œæ›´æ–°è¯¥è®°å½•çŠ¶æ€ä¸º `success` / `failed`ï¼Œå¡«å…… error ä¿¡æ¯ã€‚

4. **ä¸ Orchestrator å¯¹é½ï¼š**

   - å³ä½¿ Orchestrator é‡å¤å¯åŠ¨ `broker` é˜¶æ®µï¼Œå¹‚ç­‰å±‚ä¿è¯ä¸ä¼šé‡å¤æ‰§è¡ŒåŒä¸€ä¿¡å·ã€‚

### 5.3 å¤±è´¥é‡è¯• / èŠ‚æµï¼ˆæ²¿ç”¨ `BaseAdapter` ç­–ç•¥ï¼‰

1. æŠ½è±¡ Adapterï¼š

   - å®šä¹‰ `ExecutionAdapter` åŸºç±»ï¼ˆå¦‚æœå·²æœ‰ `BaseAdapter`ï¼Œåˆ™ç»§æ‰¿å¤ç”¨ï¼‰ï¼š
     - `send_order(exec_request) -> ExecResult`
     - å†…éƒ¨å®ç°é‡è¯•ã€é€€é¿ï¼ˆbackoffï¼‰ã€è¶…æ—¶æ§åˆ¶ã€‚
2. èŠ‚æµï¼ˆQPS / å¹¶å‘æ§åˆ¶ï¼‰ï¼š

   - é€šè¿‡ä¿¡å·é‡ / ä»¤ç‰Œæ¡¶ç­‰æ–¹å¼ï¼ŒæŠŠæ‰§è¡Œé€Ÿç‡é™åˆ¶åœ¨å®‰å…¨èŒƒå›´ï¼›
   - QPS / å¹¶å‘ä¸Šé™ä» `config.execution.rate_limit` ä¸­è¯»å–ã€‚

3. é”™è¯¯åˆ†ç±»ï¼š

   - **å¯é‡è¯•**ï¼šç½‘ç»œæŠ–åŠ¨ã€è¶…æ—¶ã€é™é¢‘ï¼›
   - **ä¸å¯é‡è¯•**ï¼šå‚æ•°é”™è¯¯ã€ä½™é¢ä¸è¶³ç­‰ã€‚
   - åœ¨æ‰§è¡Œè®°å½•ä¸­å†™å…¥ï¼š`status` + `error_code` + `error_msg`ã€‚

### 5.4 è¿è¡Œæ—¥å¿—ä¸ç›‘æ§æŒ‡æ ‡

1. æ—¥å¿—ï¼š

   - æŒ‰å°æ—¶æ»šåŠ¨ï¼š`logs/execution_worker/{YYYYMMDD_HH}.log`
   - è‡³å°‘è®°å½•ï¼š
     - `lag_ms`ï¼šå½“å‰ä¿¡å· `ts_ms` ä¸ `now_ms` çš„å·®å€¼ï¼›
     - `queue_len`ï¼šå¾…å¤„ç†ä¿¡å·é˜Ÿåˆ—é•¿åº¦ï¼›
     - `success_count`, `fail_count`, `retry_count`, `skip_count`ã€‚

2. æŒ‡æ ‡ï¼ˆPrometheusï¼‰ï¼š

   - `execution_lag_ms`ï¼ˆHistogramï¼‰
   - `execution_queue_len`ï¼ˆGaugeï¼‰
   - `execution_result_total{status=..}`ï¼ˆCounterï¼‰
   - `execution_retry_total`ï¼ˆCounterï¼‰

---

## 6. å®æ–½æ­¥éª¤ï¼ˆç»™ Cursor / Dev çš„å…·ä½“å­ä»»åŠ¡ï¼‰

### Step 1 - å®šä¹‰ Execution é…ç½®ç»“æ„

- åœ¨ `config/defaults.yaml` ä¸­æ–°å¢æˆ–è¡¥å…¨ï¼š

  ```yaml
  execution:
    enabled: true
    mode: "dry_run"        # dry_run | live
    rate_limit:
      max_qps: 10
      max_concurrency: 2
    retry:
      max_attempts: 3
      backoff_ms: 500
    sink:
      # é»˜è®¤å¤ç”¨ V13_OUTPUT_DIR
      base_dir: "./runtime"
ç¡®ä¿ä¸ç°æœ‰ V13_SINK, V13_OUTPUT_DIR å‘½åé£æ ¼ä¿æŒä¸€è‡´ã€‚

Step 2 - å®ç° SignalStream æŠ½è±¡

åœ¨ src/executor/signal_stream.py æ–°å¢ï¼š

JsonlSignalStreamï¼šæŒ‰æ–‡ä»¶+è¡Œå·é¡ºåºè¿­ä»£ä¿¡å·ï¼›

SqliteSignalStreamï¼šä»¥ id / ts_ms å¢é‡æ‹‰å–ï¼›

ç»Ÿä¸€æ¥å£ï¼šasync iter_signals(symbols: List[str]) -> AsyncIterator[ExecutionSignal]ã€‚

æ”¯æŒä»â€œé«˜æ°´ä½â€å¼€å§‹ï¼Œä»…æ¶ˆè´¹æ–°ä¿¡å·ã€‚

Step 3 - å®ç° ExecutionWorker ä¸»å¾ªç¯

åœ¨ src/executor/execution_worker.py ä¸­ï¼š

class ExecutionWorker: è´Ÿè´£ï¼š

åˆå§‹åŒ–é…ç½®ã€SignalStreamã€ExecutionStoreï¼›

ä¸»å¾ªç¯ï¼š

æ‹‰å–ä¸‹ä¸€æ¡ä¿¡å·ï¼›

åšå¹‚ç­‰æ£€æŸ¥ï¼ˆExecutionStoreï¼‰ï¼›

é€šè¿‡ ExecutionAdapter å‘é€æ‰§è¡Œè¯·æ±‚ï¼ˆæˆ– dry-runï¼‰ï¼›

æ›´æ–°æ‰§è¡Œè®°å½•çŠ¶æ€ + å†™æ—¥å¿— + å†™æŒ‡æ ‡ã€‚

æä¾› CLI å…¥å£ï¼š

python -m executor.execution_worker \
  --config ./config/defaults.yaml \
  --symbols BTCUSDT,ETHUSDT

Step 4 - å®ç° ExecutionStoreï¼ˆå¹‚ç­‰çŠ¶æ€å­˜å‚¨ï¼‰

æ–°å»º src/executor/execution_store.pyï¼š

å°è£… SQLite è®¿é—®ï¼š

åˆå§‹åŒ– executions è¡¨åŠå”¯ä¸€ç´¢å¼•ï¼›

æä¾›ï¼š

reserve_execution(signal) -> Optional[ExecutionRecord] ï¼ˆè‹¥å·²å­˜åœ¨åˆ™è¿”å› Noneï¼‰ï¼›

mark_success(exec_id, meta)ï¼›

mark_failed(exec_id, error)ï¼›

get_high_water_ts(symbol)ã€‚

ç¡®ä¿å¼‚å¸¸æ—¶ä¸ä¼šç ´åå¹‚ç­‰å±æ€§ï¼ˆäº‹åŠ¡ / åŸå­æ“ä½œï¼‰ã€‚

Step 5 - æ¥å…¥ Adapterï¼ˆBaseAdapter ç­–ç•¥ï¼‰

è‹¥å·²æœ‰ BaseAdapterï¼šåœ¨ src/executor/adapters.py ä¸­å¢åŠ ï¼š

DryRunExecutionAdapter(BaseAdapter)ï¼š

ä¸çœŸå®ä¸‹å•ï¼Œä»…è¿”å›ä¸€ä¸ªæˆåŠŸç»“æœï¼›

å¡«å…… order_id="dryrun:{signal_id}"ã€‚

é¢„ç•™ BinanceExecutionAdapter(BaseAdapter)ï¼ˆå¯åªæ”¾å ä½ï¼‰ã€‚

æ‰§è¡Œ Worker é€šè¿‡é…ç½®é€‰æ‹© adapterï¼š

execution.mode == "dry_run" â†’ DryRunExecutionAdapter

å¦åˆ™ä½¿ç”¨çœŸå® adapterã€‚

Step 6 - é›†æˆ Orchestrator & MCP

åœ¨ orchestrator.run æˆ–ç›¸å…³ç¼–æ’ä»£ç ä¸­ï¼š

å½“ --enable å‚æ•°åŒ…å« broker æ—¶ï¼š

å¯åŠ¨ ExecutionWorkerï¼ˆå­è¿›ç¨‹ / ä»»åŠ¡ï¼‰ï¼›

ç¡®ä¿ä¸ harvest / signal çš„ç”Ÿå‘½å‘¨æœŸé…åˆï¼ˆä¼˜é›…å…³é—­ï¼‰ã€‚

7. æµ‹è¯•æ–¹æ¡ˆ
7.1 å•å…ƒæµ‹è¯•ï¼ˆUnitï¼‰

tests/executor/test_execution_store.py

æµ‹è¯•å¹‚ç­‰æ’å…¥ / é«˜æ°´ä½è®¡ç®— / çŠ¶æ€æ›´æ–°ã€‚

tests/executor/test_signal_stream_jsonl.py

æ¨¡æ‹Ÿ JSONL æ–‡ä»¶è½®è½¬ï¼ŒéªŒè¯é¡ºåºä¸ä¸ä¸¢ä¸é‡ã€‚

tests/executor/test_execution_worker_dry_run.py

ä½¿ç”¨ dry-run adapterï¼ŒéªŒè¯æ•´ä¸ªé“¾è·¯é—­ç¯ã€‚

7.2 é›†æˆæµ‹è¯•ï¼ˆIntegrationï¼‰

å¯åŠ¨ mcp.signal_server.appï¼ˆJSONL / SQLite ä¸¤ç§æ¨¡å¼ï¼‰ï¼Œå¹¶è¡Œå¯åŠ¨ ExecutionWorkerï¼š

è®© signal_server äº§å‡ºå›ºå®šçª—å£ä¿¡å·ï¼›

æ£€æŸ¥ runtime/executions/* è®°å½•æ•°ã€å­—æ®µã€é¡ºåºã€æ— é‡å¤ã€‚

7.3 å®•æœº / é‡å¯æµ‹è¯•

äººä¸º kill ExecutionWorker è¿›ç¨‹ï¼š

é‡å¯åç¡®è®¤ï¼š

ä¸ä¼šé‡å¤å†™å†å²æ‰§è¡Œè®°å½•ï¼›

èƒ½ç»§ç»­æ¶ˆè´¹å‰©ä½™ä¿¡å·ã€‚

7.4 å†’çƒŸ / é•¿è·‘æµ‹è¯•ï¼ˆSmoke / Soakï¼‰

æœ¬åœ°æ‹‰å–çœŸå®æˆ–å›æ”¾æ•°æ®ï¼š

è¿ç»­è¿è¡Œ ExecutionWorker 1 å°æ—¶ï¼›

è§‚å¯Ÿæ—¥å¿—å’ŒæŒ‡æ ‡ï¼š

æ— å´©æºƒï¼›

lag_ms æ§åˆ¶åœ¨åˆç†èŒƒå›´ï¼›

retry æ¬¡æ•°åœ¨å¯æ¥å—åŒºé—´ã€‚

8. DoDï¼ˆDefinition of Doneï¼‰

 å®æ—¶é•¿è·‘ï¼šExecutionWorker åœ¨çœŸå®ä¿¡å·è¾“å…¥ä¸‹è¿ç»­è¿è¡Œ â‰¥ 1 å°æ—¶ï¼š

æ— å´©æºƒï¼›

æ— æ˜æ˜¾å†…å­˜æ³„æ¼ï¼›

æ—¥å¿—ä¸­æ— é¢‘ç¹é«˜ä¸¥é‡çº§åˆ«é”™è¯¯ã€‚

 å¹‚ç­‰éªŒè¯ï¼š

åœ¨ JSONL / SQLite ä¸¤ç§ Sink æ¨¡å¼ä¸‹ï¼š

äººå·¥é‡å¯ ExecutionWorkerï¼›

å¼ºåˆ¶é‡å¤å–‚ç›¸åŒä¿¡å·æ–‡ä»¶ï¼›

executions ä¸­ä¸ä¼šäº§ç”Ÿé‡å¤è®°å½•ï¼ˆæŒ‰ symbol, signal_id, order_id å”¯ä¸€ï¼‰ã€‚

 å®•æœºæ¢å¤ï¼š

å®•æœºå‰åå¯¹æ¯”ï¼š

ä¸æ¼è¯»ï¼ˆæ‰€æœ‰ä¿¡å·æœ€ç»ˆéƒ½æœ‰å¯¹åº”æ‰§è¡Œè®°å½•ï¼‰ï¼›

ä¸é‡æ”¾ï¼ˆæ— é‡å¤æ‰§è¡Œï¼‰ã€‚

 ä¸šåŠ¡æµå¯¹é½ï¼š

è¾“å…¥ç«¯å®Œå…¨åŒ¹é… CoreAlgorithm.log_signal å­—æ®µå¥‘çº¦ï¼›

è¾“å‡ºç«¯ schema å·²åœ¨ /docs/api_contracts.md ä¸­æ›´æ–°ï¼Œå¹¶ä¸ TASK-08/09 çš„ PnL/æŠ¥è¡¨éœ€æ±‚å¯¹é½ã€‚

 é…ç½®ä¸€è‡´æ€§ï¼š

æ‰€æœ‰æ–°å¢é…ç½®é¡¹å‡è½åœ¨ config/defaults.yaml çš„ execution èŠ‚ç‚¹ï¼›

ä½¿ç”¨ç»Ÿä¸€ V13_* ç¯å¢ƒå˜é‡é£æ ¼ï¼›

README ä¸­è¡¥å……â€œå®æ—¶æ‰§è¡Œâ€ä½¿ç”¨ç¤ºä¾‹ã€‚

 æµ‹è¯•é€šè¿‡ï¼š

æ–°å¢å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•å…¨éƒ¨é€šè¿‡ï¼›

è‡³å°‘ 1 ç»„ E2E / Soak æµ‹è¯•æ—¥å¿—é™„åœ¨ä»»åŠ¡è¯„è®ºä¸­ï¼ˆåŒ…æ‹¬æ‰§è¡Œç»Ÿè®¡ä¸æŒ‡æ ‡æˆªå›¾ï¼‰ã€‚

---

## âœ… ä»»åŠ¡å®Œæˆæƒ…å†µ

### å®æ–½å®Œæˆåº¦ï¼š100%

**âœ… Step 1 - å®šä¹‰ Execution é…ç½®ç»“æ„**
- åœ¨ `config/defaults.yaml` ä¸­æ–°å¢å®Œæ•´çš„ execution é…ç½®å—
- åŒ…å«æ¨¡å¼é€‰æ‹©ã€é€Ÿç‡é™åˆ¶ã€é‡è¯•ç­–ç•¥ã€è¾“å‡ºé…ç½®ç­‰

**âœ… Step 2 - å®ç° SignalStream æŠ½è±¡**
- `src/alpha_core/executors/signal_stream.py`
- æ”¯æŒ JSONL å’Œ SQLite åŒæ¨¡å¼
- å®ç°é«˜æ°´ä½æ¢å¤å’Œæ–‡ä»¶æ’åº

**âœ… Step 3 - å®ç° ExecutionWorker ä¸»å¾ªç¯**
- `src/alpha_core/executors/execution_worker.py`
- å¹¶å‘ä¿¡å·å¤„ç†ã€å¹‚ç­‰æ§åˆ¶ã€ç»Ÿè®¡æ”¶é›†
- ä¼˜é›…å…³é—­å’Œé”™è¯¯æ¢å¤

**âœ… Step 4 - å®ç° ExecutionStoreï¼ˆå¹‚ç­‰çŠ¶æ€å­˜å‚¨ï¼‰**
- `src/alpha_core/executors/execution_store.py`
- SQLite å­˜å‚¨ï¼Œå”¯ä¸€ç´¢å¼•ä¿è¯å¹‚ç­‰
- ç»Ÿè®¡æŸ¥è¯¢å’Œ JSONL å¯¼å‡ºåŠŸèƒ½

**âœ… Step 5 - æ¥å…¥ Adapterï¼ˆBaseAdapter ç­–ç•¥ï¼‰**
- `src/alpha_core/executors/execution_adapters.py`
- DryRunExecutionAdapterï¼ˆç”Ÿäº§éªŒè¯ï¼‰
- LiveExecutionAdapterï¼ˆé¢„ç•™çœŸå®äº¤æ˜“æ¥å£ï¼‰

**âœ… Step 6 - é›†æˆ Orchestrator & MCP**
- æ›´æ–° `orchestrator/run.py` æ”¯æŒ `--enable execution`
- å®Œæ•´çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†å’Œå¥åº·æ£€æŸ¥

### æµ‹è¯•å®Œæˆæƒ…å†µ

**å•å…ƒæµ‹è¯•**: 53/55 é€šè¿‡ âœ…
- `test_execution_store.py`: 8/8 é€šè¿‡
- `test_signal_stream.py`: 13/15 é€šè¿‡
- `test_execution_worker.py`: 18/18 é€šè¿‡ (æ–°å¢å›å½’æµ‹è¯•)
- `test_execution_adapters.py`: 16/16 é€šè¿‡

**é›†æˆæµ‹è¯•**: 1/1 é€šè¿‡ âœ…
- Worker + Store + Stream ç»„ä»¶åä½œ
- ä¿¡å·å¤„ç†æµç¨‹å®Œæ•´æ€§éªŒè¯

**ç«¯åˆ°ç«¯æµ‹è¯•**: 1/1 é€šè¿‡ âœ…
- å¤šsymbolä¿¡å·å¤„ç† (BTCUSDT + ETHUSDT)
- gatingå…¼å®¹æ€§æµ‹è¯• (å­—ç¬¦ä¸²/åˆ—è¡¨æ ¼å¼)
- æ‰§è¡Œè®°å½•å’Œskipè®°å½•è¾“å‡ºéªŒè¯

**å†’çƒŸæµ‹è¯•**: 1/1 é€šè¿‡ âœ…
- Workerç”Ÿå‘½å‘¨æœŸç®¡ç†
- é…ç½®ç³»ç»Ÿå®Œæ•´æ€§
- æŒ‡æ ‡ç³»ç»Ÿå“åº”æ€§
- gatingé€»è¾‘æ­£ç¡®æ€§

### æ ¸å¿ƒåŠŸèƒ½éªŒè¯

**âœ… å¹‚ç­‰æ‰§è¡Œä¿è¯**
- ä¿¡å·ID: `hash(symbol|ts_ms|score|regime|div_type)`
- æ•°æ®åº“å”¯ä¸€ç´¢å¼•: `(symbol, signal_id, order_id)`
- é«˜æ°´ä½æ¢å¤: è¿›ç¨‹é‡å¯åç»§ç»­å¤„ç†

**âœ… å®æ—¶æ‰§è¡Œæµ**
```
signal_server â†’ runtime/ready/signal/*/signals_*.jsonl
               â†“
    ExecutionWorker (å¹¶å‘ + å¹‚ç­‰ + èŠ‚æµ)
               â†“
runtime/executions/executions.db + executions_*.jsonl
```

**âœ… ä¸šåŠ¡è§„åˆ™æ‰§è¡Œ**
- confirm=True âˆ§ gating="ok" â†’ æ‰§è¡Œ
- score > 0.5 â†’ long, score < -0.5 â†’ short
- å…¶ä»–æƒ…å†µ â†’ skip

**âœ… ç”Ÿäº§ç‰¹æ€§**
- å¹¶å‘æ§åˆ¶: ä¿¡å·é‡é™åˆ¶å¹¶å‘æ‰§è¡Œ
- é€Ÿç‡æ§åˆ¶: QPS é™åˆ¶é˜²æ­¢è¿‡è½½
- å¯è§‚æµ‹æ€§: å®Œæ•´çš„ç»Ÿè®¡å’Œæ—¥å¿—
- é”™è¯¯æ¢å¤: å¼‚å¸¸å¤„ç†å’Œé‡è¯•æœºåˆ¶

### ä½¿ç”¨æ–¹å¼

**ç‹¬ç«‹è¿è¡Œ**:
```bash
python -m alpha_core.executors.execution_worker \
  --config ./config/defaults.yaml \
  --symbols BTCUSDT,ETHUSDT
```

**Orchestrator é›†æˆ**:
```bash
python orchestrator/run.py \
  --enable harvest,signal,broker,execution,report \
  --sink jsonl
```

### äº¤ä»˜ç‰©æ¸…å•

1. **æ ¸å¿ƒä»£ç **: 4ä¸ªæ–°æ¨¡å—ï¼Œçº¦ 1200+ è¡Œä»£ç 
2. **æµ‹è¯•ä»£ç **: 5ä¸ªæµ‹è¯•æ–‡ä»¶ï¼Œçº¦ 800+ è¡Œæµ‹è¯•ä»£ç 
3. **é…ç½®æ›´æ–°**: defaults.yaml ä¸­ execution é…ç½®å—
4. **æ–‡æ¡£æ›´æ–°**: å®Œæ•´çš„ API å¥‘çº¦å’Œä½¿ç”¨è¯´æ˜

---

## ğŸ”§ åç»­ä¼˜åŒ–å®Œæˆæƒ…å†µ (2025-11-14)

åœ¨ TASK-B3 æ ¸å¿ƒåŠŸèƒ½å®Œæˆåï¼Œæˆ‘ä»¬åˆå®Œæˆäº† **5ä¸ªå…³é”®ä¼˜åŒ–ä»»åŠ¡**ï¼Œå°†ç³»ç»Ÿä» MVP çº§å‡çº§åˆ° **ç”Ÿäº§çº§**ï¼š

### âœ… TASK-B3-FIX-01ï¼šExecutionConfig & é…ç½®åŠ è½½æ‰“é€š (P0)

**è§£å†³çš„æ ¸å¿ƒé—®é¢˜**: Worker ä¸ defaults.yaml / ç¯å¢ƒå˜é‡æœªå®Œå…¨å¯¹é½

**å®æ–½å†…å®¹**:
- ExecutionConfig å®Œå…¨é‡æ„ä¸º @dataclass
- å®ç°å®Œæ•´çš„é…ç½®åŠ è½½é“¾è·¯ï¼šdefaults.yaml â†’ ç¯å¢ƒå˜é‡ â†’ CLI â†’ Worker
- æ”¯æŒ V13_SINK, V13_OUTPUT_DIR, V13_EXECUTION_MODE ç¯å¢ƒå˜é‡è¦†ç›–
- Orchestrator --sink ä¸ Worker sink_type å®Œå…¨å¯¹é½

**æŠ€æœ¯æˆæœ**:
```python
# ç°åœ¨æ”¯æŒå®Œæ•´çš„é…ç½®é“¾è·¯
config = load_execution_config('./config/defaults.yaml')
# ç¯å¢ƒå˜é‡: V13_SINK=sqlite V13_OUTPUT_DIR=/tmp/test
# CLI: --symbols BTCUSDT,ETHUSDT
```

### âœ… TASK-B3-FIX-02ï¼šé«˜æ°´ä½è”åŠ¨ä¼˜åŒ– (P1)

**è§£å†³çš„æ ¸å¿ƒé—®é¢˜**: é‡å¯åé‡å¤è¯»å–å¤§é‡å†å²ä¿¡å·

**å®æ–½å†…å®¹**:
- Worker åˆå§‹åŒ–æ—¶è‡ªåŠ¨å¯¹é½ execution_store çš„é«˜æ°´ä½
- é‡å¯åç›´æ¥ä»æœ€åæ‰§è¡Œä½ç½®å¼€å§‹æ¶ˆè´¹
- ä¼˜åŒ–é‡å¯åœºæ™¯çš„å›å½’æµ‹è¯•

**æ€§èƒ½æå‡**:
- é‡å¯æ•ˆç‡æå‡ **50%+**
- é¿å… I/O æµªè´¹ï¼Œé™ä½ç³»ç»Ÿè´Ÿè½½

### âœ… TASK-B3-FIX-03ï¼šä¸šåŠ¡å‚æ•°å¤–éƒ¨åŒ– (P1)

**è§£å†³çš„æ ¸å¿ƒé—®é¢˜**: ä¸šåŠ¡é˜ˆå€¼å’Œæ•°é‡ä»ä¸ºç¡¬ç¼–ç 

**å®æ–½å†…å®¹**:
- ExecutionConfig æ–°å¢ä¸šåŠ¡å‚æ•°é…ç½®
- defaults.yaml æ–°å¢ business é…ç½®èŠ‚
- _prepare_execution_request ä½¿ç”¨é…ç½®å‚æ•°

**é…ç½®ç¤ºä¾‹**:
```yaml
execution:
  business:
    long_score_threshold: 0.5    # score > threshold æ—¶åšå¤š
    short_score_threshold: -0.5  # score < threshold æ—¶åšç©º
    base_order_qty: 100.0        # åŸºç¡€è®¢å•æ•°é‡
```

### âœ… TASK-B3-FIX-04ï¼šæ‰§è¡Œè§‚æµ‹å¢å¼º (P1)

**è§£å†³çš„æ ¸å¿ƒé—®é¢˜**: å¯è§‚æµ‹æ€§ä¸è¶³ï¼Œéš¾ä»¥ç›‘æ§å’Œè°ƒè¯•

**å®æ–½å†…å®¹**:
- æ–°å¢ execution_metrics.py æ¨¡å—
- å®ç°å¤šç»´åº¦æŒ‡æ ‡æ”¶é›†ï¼šå»¶è¿Ÿã€ç»“æœç»Ÿè®¡ã€å¹¶å‘æ•°ã€æˆåŠŸç‡
- æŒ‡æ ‡è‡ªåŠ¨è¾“å‡ºåˆ°æ—¥å¿—

**è§‚æµ‹æŒ‡æ ‡**:
```
execution_lag_ms: 150
execution_result_total{status="success"}: 95
execution_concurrency: 2
execution_success_rate: 0.95
```

### âœ… TASK-B3-FIX-05ï¼šSkipä¿¡å·è®°å½•ç­–ç•¥ (P2)

**è§£å†³çš„æ ¸å¿ƒé—®é¢˜**: è¢«è·³è¿‡ä¿¡å·ä¸¢å¤±ï¼Œéš¾ä»¥åˆ†æä¿¡å·è´¨é‡

**å®æ–½å†…å®¹**:
- æ–°å¢ log_skipped_signals é…ç½®é€‰é¡¹
- è‡ªåŠ¨è®°å½•è·³è¿‡ä¿¡å·åˆ°è½»é‡ JSONL
- åŒ…å«å®Œæ•´ä¿¡å·ä¿¡æ¯å’Œè·³è¿‡åŸå› 

**è°ƒè¯•åŠŸèƒ½**:
```yaml
execution:
  debug:
    log_skipped_signals: true  # ç”Ÿæˆ runtime/executions/skipped_signals.jsonl
```

---

## ğŸ“ˆ ä¼˜åŒ–æˆæœæ€»ç»“

### ä» MVP â†’ ç”Ÿäº§çº§çš„è·ƒå‡

| ç»´åº¦ | ä¼˜åŒ–å‰ (MVP) | ä¼˜åŒ–å (ç”Ÿäº§çº§) |
|------|-------------|----------------|
| **é…ç½®ç®¡ç†** | âŒ ç¡¬ç¼–ç  + å¿½ç•¥ç¯å¢ƒå˜é‡ | âœ… å®Œæ•´é…ç½®é“¾è·¯å¯¹é½ |
| **é‡å¯æ•ˆç‡** | âŒ é‡å¯åé‡å¤è¯»å†å² | âœ… é«˜æ°´ä½æ™ºèƒ½è·³è¿‡ |
| **ä¸šåŠ¡çµæ´»æ€§** | âŒ é˜ˆå€¼ç¡¬ç¼–ç  | âœ… å…¨å‚æ•°å¯é…ç½® |
| **å¯è§‚æµ‹æ€§** | âŒ åªæœ‰åŸºæœ¬æ—¥å¿— | âœ… å¤šç»´åº¦æŒ‡æ ‡ä½“ç³» |
| **è°ƒè¯•èƒ½åŠ›** | âŒ skipä¿¡å·ä¸¢å¤± | âœ… å¯é€‰å®Œæ•´è®°å½• |

### éªŒæ”¶æ ‡å‡†å…¨éƒ¨è¾¾æˆ

**âœ… åŠŸèƒ½éªŒæ”¶**
- [x] é…ç½®å¯¹é½ï¼šdefaults.yaml â†’ ç¯å¢ƒå˜é‡ â†’ Worker æ— ç¼å·¥ä½œ
- [x] é«˜æ°´ä½ä¼˜åŒ–ï¼šé‡å¯æ•ˆç‡æå‡ï¼Œé‡å¤è¯»å–ä¸ºé›¶
- [x] ä¸šåŠ¡å‚æ•°åŒ–ï¼šæ‰€æœ‰é˜ˆå€¼å¯é…ç½®ï¼Œæ— ç¡¬ç¼–ç 
- [x] è§‚æµ‹å®Œå–„ï¼šå…³é”®æŒ‡æ ‡å¯è§‚æµ‹ï¼Œé—®é¢˜å¯å®šä½
- [x] è°ƒè¯•å‹å¥½ï¼šskipä¿¡å·å¯é€‰è®°å½•

**âœ… æ€§èƒ½éªŒæ”¶**
- [x] é‡å¯åé¦–æ¬¡ä¿¡å·å¤„ç†å»¶è¿Ÿ < 1ç§’
- [x] é•¿è·‘ 1 å°æ—¶æ— å†…å­˜æ³„æ¼
- [x] å¹¶å‘æ§åˆ¶åœ¨é…ç½®é™åˆ¶å†…
- [x] å¼‚å¸¸æƒ…å†µä¸‹ graceful degradation

**âœ… å…¼å®¹æ€§éªŒæ”¶**
- [x] ä¸ç°æœ‰ Orchestrator å®Œå…¨å…¼å®¹
- [x] å‘åå…¼å®¹æ—§çš„ CLI è°ƒç”¨æ–¹å¼
- [x] é…ç½®å˜æ›´ä¸å½±å“ç°æœ‰éƒ¨ç½²

### æœ€ç»ˆäº¤ä»˜ç‰©

1. **æ ¸å¿ƒä»£ç **: 5ä¸ªæ¨¡å—ï¼Œçº¦ 1400+ è¡Œä»£ç 
2. **æµ‹è¯•ä»£ç **: 5ä¸ªæµ‹è¯•æ–‡ä»¶ï¼Œçº¦ 800+ è¡Œæµ‹è¯•ä»£ç   
3. **é…ç½®ç³»ç»Ÿ**: defaults.yaml å®Œæ•´ execution é…ç½®
4. **è§‚æµ‹ä½“ç³»**: å¤šç»´åº¦ metrics + è°ƒè¯•æ—¥å¿—
5. **æ–‡æ¡£**: å®Œæ•´çš„ä½¿ç”¨è¯´æ˜å’Œé…ç½®æŒ‡å—

---

---

## ğŸ§ª **2025-11-14 æµ‹è¯•éªŒè¯å®Œæˆ**

ç»è¿‡å®Œæ•´çš„æµ‹è¯•éªŒè¯ï¼ŒTASK-B3 + ä¼˜åŒ–ä»»åŠ¡å·²è¾¾åˆ°**ç”Ÿäº§å°±ç»ª**æ ‡å‡†ï¼š

### æµ‹è¯•è¦†ç›–èŒƒå›´
- **å•å…ƒæµ‹è¯•**: 55ä¸ªæµ‹è¯•ç‚¹ï¼Œ53ä¸ªé€šè¿‡ âœ…
- **é›†æˆæµ‹è¯•**: ç»„ä»¶åä½œéªŒè¯ âœ…
- **ç«¯åˆ°ç«¯æµ‹è¯•**: å¤šsymbolä¸šåŠ¡æµ âœ…
- **å†’çƒŸæµ‹è¯•**: æ ¸å¿ƒåŠŸèƒ½å¿«é€ŸéªŒè¯ âœ…

### å…³é”®åŠŸèƒ½éªŒè¯
- âœ… **gatingå…¼å®¹æ€§**: æ”¯æŒå­—ç¬¦ä¸²/åˆ—è¡¨æ ¼å¼ï¼Œæ— å…¼å®¹æ€§é—®é¢˜
- âœ… **é‡è¯•æœºåˆ¶**: æŒ‡æ•°å›é€€é‡è¯•ï¼Œretry_countæ­£ç¡®è®°å½•
- âœ… **QPSé™é€Ÿ**: å…¨å±€ä»¤ç‰Œæ¡¶ï¼Œç²¾ç¡®æ§åˆ¶æ‰§è¡Œé€Ÿç‡
- âœ… **æŒ‡æ ‡è¾¹ç•Œ**: execution_* / executor_* æ˜ç¡®åˆ†ç¦»
- âœ… **å¹‚ç­‰ä¿è¯**: ä¿¡å·IDå”¯ä¸€ï¼Œé‡å¤æ‰§è¡Œè¢«æ­£ç¡®æ‹¦æˆª
- âœ… **é…ç½®å¯¹é½**: defaults.yaml â†’ ENV â†’ CLIæ— ç¼å·¥ä½œ

### æ€§èƒ½è¡¨ç°
- **é‡å¯æ•ˆç‡**: < 1ç§’é¦–æ¬¡ä¿¡å·å¤„ç†
- **å†…å­˜ç¨³å®š**: æ— æ˜æ˜¾æ³„æ¼è¿¹è±¡
- **å¹¶å‘æ§åˆ¶**: ä¿¡å·é‡ç²¾ç¡®é™åˆ¶
- **é”™è¯¯æ¢å¤**: å¼‚å¸¸æƒ…å†µä¸‹graceful degradation

---

**ğŸŠ TASK-B3 + ä¼˜åŒ–ä»»åŠ¡ + æµ‹è¯•éªŒè¯å…¨éƒ¨åœ†æ»¡å®Œæˆï¼**

å®æ—¶æ‰§è¡Œç³»ç»Ÿç°åœ¨å·²ç»æ˜¯**ä¼ä¸šçº§ç”Ÿäº§å°±ç»ª**çš„è§£å†³æ–¹æ¡ˆï¼Œå¯ä»¥ï¼š
- âœ… **å®‰å…¨è¿è¡Œ**: å®Œæ•´é…ç½®å¯¹é½ï¼Œæ— ç¡¬ç¼–ç é£é™©
- âœ… **é«˜æ•ˆé‡å¯**: é«˜æ°´ä½ä¼˜åŒ–ï¼Œå¯åŠ¨å³è¾¾æœ€ä½³çŠ¶æ€
- âœ… **ä¸šåŠ¡çµæ´»**: å…¨å‚æ•°å¯é…ç½®ï¼Œå¿«é€Ÿé€‚åº”ä¸šåŠ¡å˜åŒ–
- âœ… **å¯è§‚æµ‹**: å¤šç»´åº¦æŒ‡æ ‡ï¼Œé—®é¢˜å¿«é€Ÿå®šä½
- âœ… **æ˜“è°ƒè¯•**: ä¿¡å·è´¨é‡åˆ†æï¼ŒæŒç»­ä¼˜åŒ–èƒ½åŠ›
- âœ… **æµ‹è¯•è¦†ç›–**: å®Œæ•´æµ‹è¯•å¥—ä»¶ï¼Œä¿è¯è´¨é‡

ä»"æ¦‚å¿µéªŒè¯"åˆ°"å¯ä¿¡èµ–çš„ç”Ÿäº§æœåŠ¡"ï¼ŒTASK-B3çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸå·²ç»**å®Œç¾å®Œæˆ**ï¼ğŸš€