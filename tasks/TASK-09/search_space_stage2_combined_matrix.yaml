stage: 2
description: "STAGE-2 组合矩阵：F2-F5联合优化（2×2×2×2=16组）"
target: "同时满足所有硬约束：avg_pnl_per_trade≥0, pnl_net≥0, trades_per_hour≤20, cost_bps≤1.75"
search_space:
  # F2: 融合权重
  components.fusion.w_ofi: [0.6, 0.7]
  # F4: Regime阈值
  signal.thresholds.quiet.buy: [1.2, 1.4]
  signal.thresholds.quiet.sell: [-1.4, -1.2]
  signal.thresholds.active.buy: [0.6, 0.8]
  signal.thresholds.active.sell: [-0.8, -0.6]
  # F3: 反抖与冷却
  signal.min_consecutive_same_dir: [4, 5]
  execution.cooldown_ms: [800, 1200]
  # F5: TP/SL
  backtest.take_profit_bps: [15, 18]
  backtest.stop_loss_bps: [8, 10]
  note: "组合矩阵：2×2×2×2=16组（如需减量，优先固定TP/SL变成8组）"

constraints:
  trades_per_hour:
    max: 20
    description: "频率硬约束 ≤20/h"
  cost_bps_on_turnover:
    max: 1.75
    description: "成本硬约束 ≤1.75 bps"

scoring_weights:
  pnl_net: 1.0
  avg_pnl_per_trade: 0.6
  trades_per_hour: -0.4
  cost_bps_on_turnover: -0.5
  win_rate_trades: 0.0
  description: "STAGE-2: 纳入成本和密度，重点优化PNL和单笔收益"

hard_constraints:
  avg_pnl_per_trade: ">= 0"
  pnl_net: ">= 0"
  trades_per_hour: "<= 20"
  cost_bps_on_turnover: "<= 1.75"

